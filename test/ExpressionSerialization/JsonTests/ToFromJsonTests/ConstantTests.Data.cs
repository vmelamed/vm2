namespace vm2.ExpressionSerialization.JsonTests.ToFromJsonTests;

using System.Collections;
using System.Collections.Concurrent;
using System.Collections.Frozen;
using System.Collections.Immutable;
using System.Collections.ObjectModel;

using vm2.ExpressionSerialization.JsonTests;

public partial class ConstantTests
{
    public static readonly TheoryData<string, string, string> ConstantsData = new ()
    {
        { TestLine(), "(byte)5",  "Byte.json" },
        { TestLine(), "(Half)3.14", "Half.json" },
        { TestLine(), "(int?)5", "NullableInt.json" },
        { TestLine(), "(int?)null", "NullNullableInt.json" },
        { TestLine(), "(IntField: 1, StringField: \"one\")", "ValueTupleIntString.json" },
        { TestLine(), "(IntPtr)5", "IntPtr.json" },
        { TestLine(), "(long?)5L", "NullableLong.json" },
        { TestLine(), "(long?)null", "NullNullableLong.json" },
        { TestLine(), "(Object1)null", "Object1Null.json" },
        { TestLine(), "(sbyte)5",  "SByte.json" },
        { TestLine(), "(short)5",  "Short.json" },
        { TestLine(), "(StructDataContract1)null", "NullNullableStructDataContract1.json" },
        { TestLine(), "(StructSerializable1)null", "NullNullableStructSerializable1.json" },
        { TestLine(), "(uint)5",  "UInt.json" },
        { TestLine(), "(UIntPtr)5", "UIntPtr.json" },
        { TestLine(), "(ulong)5",  "ULong.json" },
        { TestLine(), "(ushort)5",  "UShort.json" },
        { TestLine(), "5",  "Int.json" },
        { TestLine(), "5.1234567891234567E-123",  "Double.json" },
        { TestLine(), "5.5123453E-34F",  "Float.json" },
        { TestLine(), "5.5M",  "Decimal.json" },
        { TestLine(), "5L",  "Long.json" },
        { TestLine(), "abrah-cadabrah",  "String.json" },
        { TestLine(), "anonymous", "Anonymous.json" },
        { TestLine(), "ArraySegment<byte>", "ByteArraySegment.json" },
        { TestLine(), "ArraySegment<int>([ 1, 2, 3, 4 ], 1, 2)", "IntArraySegment.json" },
        { TestLine(), "BlockingCollection<double>()", "BlockingCollection.json" },
        { TestLine(), "byte[]{ 1, 2, 3, 1, 2, 3, 1, 2, 3, 10 }", "ByteArray.json" },
        { TestLine(), "ClassDataContract1()", "ClassDataContract1.json" },
        { TestLine(), "ClassDataContract1[] { new ClassDataContract1(), new ClassDataContract2(), null }", "ArrayWithClassDataContract1and2.json" },
        { TestLine(), "ClassDataContract1[] { new(0, \"vm\"), new(1, \"vm2 vm\"), }", "ArrayOfClassDataContract1.json" },
        { TestLine(), "ClassDataContract2()", "ClassDataContract2.json" },
        { TestLine(), "ClassSerializable1()", "ClassSerializable1.json" },
        { TestLine(), "Collection<int>([1, 2, 3, 4])", "IntCollection.json" },
        { TestLine(), "ConcurrentBag<int>([1, 2, 3, 4])", "IntConcurrentBag.json" },
        { TestLine(), "ConcurrentDictionary<int, string>{ [1] = \"one\", [2]=\"two\" }", "ConcurrentDictionaryIntString.json" },
        { TestLine(), "ConcurrentQueue<int>([1, 2, 3, 4])", "IntConcurrentQueue.json" },
        { TestLine(), "ConcurrentStack<int>([1, 2, 3, 4])", "IntConcurrentStack.json" },
        { TestLine(), "DateTime(2024, 4, 13, 23, 18, 26, 234, DateTimeKind.Local)", "DateTime.json" },
        { TestLine(), "DateTimeOffset(2024, 4, 13, 23, 18, 26, 234, new TimeSpan(0, -300, 0))", "DateTimeOffset.json" },
        { TestLine(), "DBNull.Value", "DBNull.json" },
        { TestLine(), "Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" }", "DictionaryIntString.json" },
        { TestLine(), "Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" }", "DictionaryIntString.json" },
        { TestLine(), "EnumFlagsTest.One | EnumFlagsTest.Three",  "EnumFlags.json" },
        { TestLine(), "EnumTest.Three",  "Enum.json" },
        { TestLine(), "EnumTest?[]{ EnumTest.One, EnumTest.Two, null, null }", "ArrayOfNullableEnums.json" },
        { TestLine(), "false", "False.json" },
        { TestLine(), "Frozen byte[]{ 1, 2, 3, 1, 2, 3, 1, 2, 3, 10 }", "ByteArrayFrozen.json" },
        { TestLine(), "Frozen decimal[]{ 1, 2, 3, 4 }", "DecimalFrozenSet.json" },
        { TestLine(), "Frozen Dictionary<int, string?>{ [1] = \"one\", [2] = \"two\", [3] = null, [4] = null }", "IntNullableStringDictionary.json" },
        { TestLine(), "Frozen Dictionary<int, string>{ [1] = \"one\", [2] = \"two\", [3] = \"three\", }", "IntStringDictionaryFrozen.json" },
        { TestLine(), "Frozen Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" }", "FrozenDictionaryIntString.json" },
        { TestLine(), "Frozen EnumTest?[]{ EnumTest.One, EnumTest.Two, null, null }", "ArrayOfNullableEnumsFrozen.json" },
        { TestLine(), "Frozen int?[]{ 1, 2, null, null }", "ArrayOfNullableIntFrozen.json" },
        { TestLine(), "Frozen int[]{ 1, 2, 3, 4 }", "ArrayOfIntFrozen.json" },
        { TestLine(), "Frozen object[anonymous]", "AnonymousFrozenArray.json" },
        { TestLine(), "Guid(\"00112233-4455-6677-8899-aabbccddeeff\")", "Guid.json" },
        { TestLine(), "HashSet<int>([1, 2, 3, 4])", "IntHashSet.json" },
        { TestLine(), "Hashtable(new Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" })", "Dictionary.json" },
        { TestLine(), "ImmutableArray.Create(1, 2, 3, 4 )", "IntImmutableArray.json" },
        { TestLine(), "ImmutableDictionary.Create<int,string>().Add(1, \"one\").Add(2, \"two\")", "ImmutableDictionaryIntString.json" },
        { TestLine(), "ImmutableHashSet.Create(1, 2, 3, 4 )", "IntImmutableHashSet.json" },
        { TestLine(), "ImmutableList.Create(1, 2, 3, 4 )", "IntImmutableList.json" },
        { TestLine(), "ImmutableQueue.Create(1, 2, 3, 4 )", "IntImmutableQueue.json" },
        { TestLine(), "ImmutableSortedDictionary.Create<int,string>().Add(1, \"one\").Add(2, \"two\")", "ImmutableSortedDictionaryIntString.json" },
        { TestLine(), "ImmutableSortedSet.Create(1, 2, 3, 4 )", "IntImmutableSortedSet.json" },
        { TestLine(), "ImmutableStack.Create(1, 2, 3, 4 )", "IntImmutableStack.json" },
        { TestLine(), "int?[]{ 1, 2, null, null }", "ArrayOfNullableInt.json" },
        { TestLine(), "int[]{ 1, 2, 3, 4 }", "ArrayOfInt.json" },
        { TestLine(), "LinkedList<int>([1, 2, 3, 4])", "IntLinkedList.json" },
        { TestLine(), "List<int?>{ 1, 2, null, null }", "ListOfNullableInt.json" },
        { TestLine(), "List<int>([1, 2, 3, 4])", "IntList.json" },
        { TestLine(), "Memory<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10 ])", "ByteMemory.json" },
        { TestLine(), "Memory<int>([ 1, 2, 3, 4 ])", "IntMemory.json" },
        { TestLine(), "null",  "NullObject.json" },
        { TestLine(), "object()", "Object.json" },
        { TestLine(), "Object1()", "Object1.json" },
        { TestLine(), "Queue<int>([ 1, 2, 3, 4 ])", "IntQueue.json" },
        { TestLine(), "Queue<int>([1, 2, 3, 4])", "IntQueue.json" },
        { TestLine(), "ReadOnlyCollection<int>([1, 2, 3, 4])", "IntReadOnlyCollection.json" },
        { TestLine(), "ReadOnlyDictionary<int, string>(new Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" })", "ReadOnlyDictionaryIntString.json" },
        { TestLine(), "ReadOnlyMemory<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10 ])", "ByteReadOnlyMemory.json" },
        { TestLine(), "ReadOnlyMemory<int>([ 1, 2, 3, 4 ])", "IntReadOnlyMemory.json" },
        { TestLine(), "SortedDictionary<int, string>{ [1] =\"one\", [2]=\"two\" }", "SortedDictionaryIntString.json" },
        { TestLine(), "SortedSet<int>([1, 2, 3, 4])", "IntSortedSet.json" },
        { TestLine(), "Stack<int>([ 1, 2, 3, 4 ])", "IntStack.json" },
        { TestLine(), "Stack<int>([1, 2, 3, 4])", "IntStack.json" },
        { TestLine(), "StructDataContract1() { IntProperty = 7, StringProperty = \"vm\" }", "StructDataContract1-2.json" },
        { TestLine(), "StructDataContract1()", "StructDataContract1.json" },
        { TestLine(), "StructDataContract1?() { IntProperty = 7, StringProperty = \"vm\" }", "NullableStructDataContract1.json" },
        { TestLine(), "StructDataContract1?[]", "ArrayOfNullableStructDataContract1.json" },
        { TestLine(), "StructDataContract1[]", "ArrayOfStructDataContract1.json" },
        { TestLine(), "StructSerializable1() { IntProperty = 7, StringProperty = \"vm\" }", "NullableStructSerializable1.json" },
        { TestLine(), "StructSerializable1()", "StructSerializable1.json" },
        { TestLine(), "StructSerializable1?[]", "ArrayOfNullableStructSerializable1.json" },
        { TestLine(), "StructSerializable1[]", "ArrayOfStructSerializable1.json" },
        { TestLine(), "TimeSpan(3, 4, 15, 32, 123)", "TimeSpan.json" },
        { TestLine(), "true",  "Bool.json" },
        { TestLine(), "Tuple<int, string>(1, \"one\")", "ClassTupleIntString.json" },
        { TestLine(), "Uri(\"http://www.delinea.com\")", "Uri.json" },
        { TestLine(), "'V'",  "Char.json" },
    };

    static Dictionary<string, ConstantExpression> _substitutes = new()
    {
        ["(byte)5"]                                                                                         = Expression.Constant((byte)5),
        ["(Half)3.14"]                                                                                      = Expression.Constant((Half)3.14),
        ["(int?)5"]                                                                                         = Expression.Constant(5, typeof(int?)),
        ["(int?)null"]                                                                                      = Expression.Constant(null, typeof(int?)),
        ["(IntField: 1, StringField: \"one\")"]                                                             = Expression.Constant((IntField: 1, StringField: "one")),
        ["(IntPtr)5"]                                                                                       = Expression.Constant((IntPtr)5),
        ["(long?)5L"]                                                                                       = Expression.Constant(5L, typeof(long?)),
        ["(long?)null"]                                                                                     = Expression.Constant(null, typeof(long?)),
        ["(Object1)null"]                                                                                   = Expression.Constant(null, typeof(Object1)),
        ["(sbyte)5"]                                                                                        = Expression.Constant((sbyte)5),
        ["(short)5"]                                                                                        = Expression.Constant((short)5),
        ["(StructDataContract1)null"]                                                                       = Expression.Constant(null, typeof(StructDataContract1?)),
        ["(StructSerializable1)null"]                                                                       = Expression.Constant(null, typeof(StructSerializable1?)),
        ["(uint)5"]                                                                                         = Expression.Constant((uint)5),
        ["(UIntPtr)5"]                                                                                      = Expression.Constant((UIntPtr)5),
        ["(ulong)5"]                                                                                        = Expression.Constant((ulong)5),
        ["(ushort)5"]                                                                                       = Expression.Constant((ushort)5),
        ["5"]                                                                                               = Expression.Constant(5),
        ["5.1234567891234567E-123"]                                                                         = Expression.Constant(5.1234567891234567E-123),
        ["5.5123453E-34F"]                                                                                  = Expression.Constant(5.5123453E-34F),
        ["5.5M"]                                                                                            = Expression.Constant(5.5M),
        ["5L"]                                                                                              = Expression.Constant(5L),
        ["abrah-cadabrah"]                                                                                  = Expression.Constant("abrah-cadabrah"),
        ["anonymous"]                                                                                       = Expression.Constant(
                                                                                                                                    new
                                                                                                                                    {
                                                                                                                                        ObjectProperty = (object?)null,
                                                                                                                                        NullIntProperty = (int?)null,
                                                                                                                                        NullLongProperty = (long?)1L,
                                                                                                                                        BoolProperty = true,
                                                                                                                                        CharProperty = 'A',
                                                                                                                                        ByteProperty = (byte)1,
                                                                                                                                        SByteProperty = (sbyte)1,
                                                                                                                                        ShortProperty = (short)1,
                                                                                                                                        IntProperty = 1,
                                                                                                                                        LongProperty = (long)1,
                                                                                                                                        UShortProperty = (ushort)1,
                                                                                                                                        UIntProperty = (uint)1,
                                                                                                                                        ULongProperty = (ulong)1,
                                                                                                                                        DoubleProperty = 1.0,
                                                                                                                                        FloatProperty = (float)1.0,
                                                                                                                                        DecimalProperty = 1M,
                                                                                                                                        GuidProperty = Guid.Empty,
                                                                                                                                        UriProperty = new Uri("http://localhost"),
                                                                                                                                        DateTimeProperty = new DateTime(2013, 1, 13),
                                                                                                                                        TimeSpanProperty = new TimeSpan(123L),
                                                                                                                                        DateTimeOffsetProperty = new DateTimeOffset(new DateTime(2013, 1, 13)),
                                                                                                                                    }),
        ["ArraySegment<byte>"]                                                                              = Expression.Constant(new ArraySegment<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10], 1, 8)),
        ["ArraySegment<int>([ 1, 2, 3, 4 ], 1, 2)"]                                                         = Expression.Constant(new ArraySegment<int>([ 1, 2, 3, 4 ], 1, 2)),
        ["BlockingCollection<double>()"]                                                                    = Expression.Constant(new BlockingCollection<double>() { Math.PI, Math.Tau, Math.E }),
        ["byte[]{ 1, 2, 3, 1, 2, 3, 1, 2, 3, 10 }"]                                                         = Expression.Constant(new byte[]{ 1, 2, 3, 1, 2, 3, 1, 2, 3, 10 }),
        ["ClassDataContract1()"]                                                                            = Expression.Constant(new ClassDataContract1()),
        ["ClassDataContract1[] { new ClassDataContract1(), new ClassDataContract2(), null }"]               = Expression.Constant(new ClassDataContract1?[] { new(), new ClassDataContract2(), null }),
        ["ClassDataContract1[] { new(0, \"vm\"), new(1, \"vm2 vm\"), }"]                                    = Expression.Constant(new ClassDataContract1[] { new(0, "vm"), new(1, "vm2 vm"), }),
        ["ClassDataContract2()"]                                                                            = Expression.Constant(new ClassDataContract2(1, "two", 3M), typeof(ClassDataContract1)),
        ["ClassSerializable1()"]                                                                            = Expression.Constant(new ClassSerializable1()),
        ["Collection<int>([1, 2, 3, 4])"]                                                                   = Expression.Constant(new Collection<int>([1, 2, 3, 4])),
        ["ConcurrentBag<int>([1, 2, 3, 4])"]                                                                = Expression.Constant(new ConcurrentBag<int>([1, 2, 3, 4])),
        ["ConcurrentDictionary<int, string>{ [1] = \"one\", [2]=\"two\" }"]                                 = Expression.Constant(new ConcurrentDictionary<int, string>{ [1] ="one", [2]="two" }),
        ["ConcurrentQueue<int>([1, 2, 3, 4])"]                                                              = Expression.Constant(new ConcurrentQueue<int>([1, 2, 3, 4])),
        ["ConcurrentStack<int>([1, 2, 3, 4])"]                                                              = Expression.Constant(new ConcurrentStack<int>([1, 2, 3, 4])),
        ["DateTime(2024, 4, 13, 23, 18, 26, 234, DateTimeKind.Local)"]                                      = Expression.Constant(new DateTime(2024, 4, 13, 23, 18, 26, 234, DateTimeKind.Local)),
        ["DateTimeOffset(2024, 4, 13, 23, 18, 26, 234, new TimeSpan(0, -300, 0))"]                          = Expression.Constant(new DateTimeOffset(2024, 4, 13, 23, 18, 26, 234, new TimeSpan(0, -300, 0))),
        ["DBNull.Value"]                                                                                    = Expression.Constant(DBNull.Value),
        ["Dictionary<int, string?>{ [1] = \"one\", [2] = \"two\", [3] = null, [4] = null }"]                = Expression.Constant(new Dictionary<int, string?>{ [1] = "one", [2] = "two", [3] = null, [4] = null }),
        ["Dictionary<int, string>{ [1] = \"one\", [2] = \"two\", [3] = \"three\", }"]                       = Expression.Constant(new Dictionary<int, string>{ [1] = "one", [2] = "two", [3] = "three", }),
        ["Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" }"]                                            = Expression.Constant(new Dictionary<int, string>{ [1] ="one", [2]="two" }),
        ["EnumFlagsTest.One | EnumFlagsTest.Three"]                                                         = Expression.Constant(EnumFlagsTest.One | EnumFlagsTest.Three),
        ["EnumTest.Three"]                                                                                  = Expression.Constant(EnumTest.Three),
        ["EnumTest?[]{ EnumTest.One, EnumTest.Two, null, null }"]                                           = Expression.Constant(new EnumTest?[]{ EnumTest.One, EnumTest.Two, null, null }),
        ["false"]                                                                                           = Expression.Constant(false),
        ["Frozen byte[]{ 1, 2, 3, 1, 2, 3, 1, 2, 3, 10 }"]                                                  = Expression.Constant(new byte[]{ 1, 2, 3, 1, 2, 3, 1, 2, 3, 10 }.ToFrozenSet()),
        ["Frozen decimal[]{ 1, 2, 3, 4 }"]                                                                  = Expression.Constant(new decimal[]{ 1, 2, 3, 4 }.ToFrozenSet()),
        ["Frozen Dictionary<int, string?>{ [1] = \"one\", [2] = \"two\", [3] = null, [4] = null }"]         = Expression.Constant(new Dictionary<int, string?>{ [1] = "one", [2] = "two", [3] = null, [4] = null }.ToFrozenDictionary()),
        ["Frozen Dictionary<int, string>{ [1] = \"one\", [2] = \"two\", [3] = \"three\", }"]                = Expression.Constant(new Dictionary<int, string>{ [1] = "one", [2] = "two", [3] = "three", }.ToFrozenDictionary()),
        ["Frozen Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" }"]                                     = Expression.Constant(new Dictionary<int, string>{ [1] ="one", [2]="two" }.ToFrozenDictionary()),
        ["Frozen EnumTest?[]{ EnumTest.One, EnumTest.Two, null, null }"]                                    = Expression.Constant(new EnumTest?[]{ EnumTest.One, EnumTest.Two, null, null }.ToFrozenSet()),
        ["Frozen int?[]{ 1, 2, null, null }"]                                                               = Expression.Constant(new int?[]{ 1, 2, null, null }.ToFrozenSet()),
        ["Frozen int[]{ 1, 2, 3, 4 }"]                                                                      = Expression.Constant(new int[]{ 1, 2, 3, 4 }.ToFrozenSet()),
        ["Frozen object[anonymous]"]                                                                        = Expression.Constant(new object?[] {
                                                                                                                                    new
                                                                                                                                    {
                                                                                                                                        ObjectProperty = (object?)null,
                                                                                                                                        NullIntProperty = (int?)null,
                                                                                                                                        NullLongProperty = (long?)1L,
                                                                                                                                        BoolProperty = true,
                                                                                                                                        CharProperty = 'A',
                                                                                                                                        ByteProperty = (byte)1,
                                                                                                                                        SByteProperty = (sbyte)1,
                                                                                                                                        ShortProperty = (short)1,
                                                                                                                                        IntProperty = 1,
                                                                                                                                        LongProperty = (long)1,
                                                                                                                                        UShortProperty = (ushort)1,
                                                                                                                                        UIntProperty = (uint)1,
                                                                                                                                        ULongProperty = (ulong)1,
                                                                                                                                        DoubleProperty = 1.0,
                                                                                                                                        FloatProperty = (float)1.0,
                                                                                                                                        DecimalProperty = 1M,
                                                                                                                                        GuidProperty = Guid.Empty,
                                                                                                                                        UriProperty = new Uri("http://localhost"),
                                                                                                                                        DateTimeProperty = new DateTime(2013, 1, 13),
                                                                                                                                        TimeSpanProperty = new TimeSpan(123L),
                                                                                                                                        DateTimeOffsetProperty = new DateTimeOffset(new DateTime(2013, 1, 13)),
                                                                                                                                    },
                                                                                                                                    new
                                                                                                                                    {
                                                                                                                                        ObjectProperty = (object?)null,
                                                                                                                                        NullIntProperty = (int?)null,
                                                                                                                                        NullLongProperty = (long?)2L,
                                                                                                                                        BoolProperty = true,
                                                                                                                                        CharProperty = 'A',
                                                                                                                                        ByteProperty = (byte)2,
                                                                                                                                        SByteProperty = (sbyte)2,
                                                                                                                                        ShortProperty = (short)2,
                                                                                                                                        IntProperty = 2,
                                                                                                                                        LongProperty = (long)2,
                                                                                                                                        UShortProperty = (ushort)2,
                                                                                                                                        UIntProperty = (uint)2,
                                                                                                                                        ULongProperty = (ulong)2,
                                                                                                                                        DoubleProperty = 2.0,
                                                                                                                                        FloatProperty = (float)2.0,
                                                                                                                                        DecimalProperty = 2M,
                                                                                                                                        GuidProperty = Guid.Empty,
                                                                                                                                        UriProperty = new Uri("http://localhost"),
                                                                                                                                        DateTimeProperty = new DateTime(2013, 2, 13),
                                                                                                                                        TimeSpanProperty = new TimeSpan(123L),
                                                                                                                                        DateTimeOffsetProperty = new DateTimeOffset(new DateTime(2013, 2, 13)),
                                                                                                                                    },
                                                                                                                                    null
                                                                                                                                }.ToFrozenSet()),
        ["Guid(\"00112233-4455-6677-8899-aabbccddeeff\")"]                                                  = Expression.Constant(new Guid("00112233-4455-6677-8899-aabbccddeeff")),
        ["HashSet<int>([1, 2, 3, 4])"]                                                                      = Expression.Constant(new HashSet<int>([1, 2, 3, 4])),
        ["Hashtable(new Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" })"]                             = Expression.Constant(new Hashtable(new Dictionary<int, string>{ [1] ="one", [2]="two" })),
        ["ImmutableArray.Create(1, 2, 3, 4 )"]                                                              = Expression.Constant(ImmutableArray.Create(1, 2, 3, 4 )),
        ["ImmutableDictionary.Create<int,string>().Add(1, \"one\").Add(2, \"two\")"]                        = Expression.Constant(ImmutableDictionary.Create<int,string>().Add(1, "one").Add(2, "two")),
        ["ImmutableHashSet.Create(1, 2, 3, 4 )"]                                                            = Expression.Constant(ImmutableHashSet.Create(1, 2, 3, 4 )),
        ["ImmutableList.Create(1, 2, 3, 4 )"]                                                               = Expression.Constant(ImmutableList.Create(1, 2, 3, 4 )),
        ["ImmutableQueue.Create(1, 2, 3, 4 )"]                                                              = Expression.Constant(ImmutableQueue.Create(1, 2, 3, 4 )),
        ["ImmutableSortedDictionary.Create<int,string>().Add(1, \"one\").Add(2, \"two\")"]                  = Expression.Constant(ImmutableSortedDictionary.Create<int,string>().Add(1, "one").Add(2, "two")),
        ["ImmutableSortedSet.Create(1, 2, 3, 4 )"]                                                          = Expression.Constant(ImmutableSortedSet.Create(1, 2, 3, 4 )),
        ["ImmutableStack.Create(1, 2, 3, 4 )"]                                                              = Expression.Constant(ImmutableStack.Create(1, 2, 3, 4 )),
        ["int?[]{ 1, 2, null, null }"]                                                                      = Expression.Constant(new int?[]{ 1, 2, null, null }),
        ["int[]{ 1, 2, 3, 4 }"]                                                                             = Expression.Constant(new int[]{ 1, 2, 3, 4 }),
        ["LinkedList<int>([1, 2, 3, 4])"]                                                                   = Expression.Constant(new LinkedList<int>([1, 2, 3, 4])),
        ["List<int?>{ 1, 2, null, null }"]                                                                  = Expression.Constant(new List<int?>{ 1, 2, null, null }),
        ["List<int>([1, 2, 3, 4])"]                                                                         = Expression.Constant(new List<int>([1, 2, 3, 4])),
        ["Memory<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10 ])"]                                                  = Expression.Constant(new Memory<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10 ])),
        ["Memory<int>([ 1, 2, 3, 4 ])"]                                                                     = Expression.Constant(new Memory<int>([ 1, 2, 3, 4 ])),
        ["null"]                                                                                            = Expression.Constant(null),
        ["object()"]                                                                                        = Expression.Constant(new object()),
        ["Object1()"]                                                                                       = Expression.Constant(new Object1(), typeof(Object1)),
        ["Queue<int>([ 1, 2, 3, 4 ])"]                                                                      = Expression.Constant(new Queue<int>([ 1, 2, 3, 4 ])),
        ["Queue<int>([1, 2, 3, 4])"]                                                                        = Expression.Constant(new Queue<int>([1, 2, 3, 4])),
        ["ReadOnlyCollection<int>([1, 2, 3, 4])"]                                                           = Expression.Constant(new ReadOnlyCollection<int>([1, 2, 3, 4])),
        ["ReadOnlyDictionary<int, string>(new Dictionary<int, string>{ [1] =\"one\", [2]=\"two\" })"]       = Expression.Constant(new ReadOnlyDictionary<int, string>(new Dictionary<int, string>{ [1] ="one", [2]="two" })),
        ["ReadOnlyMemory<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10 ])"]                                          = Expression.Constant(new ReadOnlyMemory<byte>([1, 2, 3, 1, 2, 3, 1, 2, 3, 10 ])),
        ["ReadOnlyMemory<int>([ 1, 2, 3, 4 ])"]                                                             = Expression.Constant(new ReadOnlyMemory<int>([ 1, 2, 3, 4 ])),
        ["SortedDictionary<int, string>{ [1] =\"one\", [2]=\"two\" }"]                                      = Expression.Constant(new SortedDictionary<int, string>{ [1] ="one", [2]="two" }),
        ["SortedSet<int>([1, 2, 3, 4])"]                                                                    = Expression.Constant(new SortedSet<int>([1, 2, 3, 4])),
        ["Stack<int>([ 1, 2, 3, 4 ])"]                                                                      = Expression.Constant(new Stack<int>([ 1, 2, 3, 4 ])),
        ["Stack<int>([1, 2, 3, 4])"]                                                                        = Expression.Constant(new Stack<int>([1, 2, 3, 4])),
        ["StructDataContract1() { IntProperty = 7, StringProperty = \"vm\" }"]                              = Expression.Constant(new StructDataContract1() { IntProperty = 7, StringProperty = "vm" }, typeof(StructDataContract1)),
        ["StructDataContract1()"]                                                                           = Expression.Constant(new StructDataContract1()),
        ["StructDataContract1?() { IntProperty = 7, StringProperty = \"vm\" }"]                             = Expression.Constant((StructDataContract1?)new StructDataContract1() { IntProperty = 7, StringProperty = "vm" }, typeof(StructDataContract1?)),
        ["StructDataContract1?[]"]                                                                          = Expression.Constant(new StructDataContract1?[]
                                                                                                                                    {
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 0,
                                                                                                                                            StringProperty = "vm",
                                                                                                                                        },
                                                                                                                                        null,
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 1,
                                                                                                                                            StringProperty = "vm vm",
                                                                                                                                        },
                                                                                                                                        null
                                                                                                                                    }),
        ["StructDataContract1[]"]                                                                           = Expression.Constant(new StructDataContract1[]
                                                                                                                                    {
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 0,
                                                                                                                                            StringProperty = "vm",
                                                                                                                                        },
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 1,
                                                                                                                                            StringProperty = "vm vm",
                                                                                                                                        },
                                                                                                                                    }),
        ["StructSerializable1() { IntProperty = 7, StringProperty = \"vm\" }"]                              = Expression.Constant(new StructSerializable1() { IntProperty = 7, StringProperty = "vm" }, typeof(StructSerializable1)),
        ["StructSerializable1()"]                                                                           = Expression.Constant(new StructSerializable1()),
        ["StructSerializable1?[]"]                                                                          = Expression.Constant(new StructSerializable1?[]
                                                                                                                                    {
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 0,
                                                                                                                                            StringProperty = "vm",
                                                                                                                                        },
                                                                                                                                        null,
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 1,
                                                                                                                                            StringProperty = "vm vm",
                                                                                                                                        },
                                                                                                                                        null
                                                                                                                                    }),
        ["StructSerializable1[]"]                                                                           = Expression.Constant(new StructSerializable1[]
                                                                                                                                    {
                                                                                                                                        new () {
                                                                                                                                            IntProperty = 0,
                                                                                                                                            StringProperty = "vm",
                                                                                                                                        },
                                                                                                                                        new() {
                                                                                                                                            IntProperty = 1,
                                                                                                                                            StringProperty = "vm vm",
                                                                                                                                        },
                                                                                                                                    }),
        ["TimeSpan(3, 4, 15, 32, 123)"]                                                                     = Expression.Constant(new TimeSpan(3, 4, 15, 32, 123)),
        ["true"]                                                                                            = Expression.Constant(true),
        ["Tuple<int, string>(1, \"one\")"]                                                                  = Expression.Constant(new Tuple<int, string>(1, "one")),
        ["Uri(\"http://www.delinea.com\")"]                                                                 = Expression.Constant(new Uri("http://www.delinea.com")),
        ["'V'"]                                                                                             = Expression.Constant('V'),
    };
}
