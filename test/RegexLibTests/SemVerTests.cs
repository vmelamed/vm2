namespace vm2.RegexLibTests;

public class SemVerTests(ITestOutputHelper output) : RegexTests(output)
{
    public static TheoryData<string, bool, string, Captures?> SemVerTestData => new() {
        { TestLine(), true,  "0.0.4", new() {  ["core"] = "0.0.4", ["major"] = "0", ["minor"] = "0", ["patch"] = "4", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "1.2.3", new() {  ["core"] = "1.2.3", ["major"] = "1", ["minor"] = "2", ["patch"] = "3", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "10.20.30", new() {  ["core"] = "10.20.30", ["major"] = "10", ["minor"] = "20", ["patch"] = "30", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "1.1.2-prerelease+meta", new() {  ["core"] = "1.1.2", ["major"] = "1", ["minor"] = "1", ["patch"] = "2", ["pre"] = "prerelease", ["build"] = "meta" } },
        { TestLine(), true,  "1.1.3-123.abc.0+meta", new() {  ["core"] = "1.1.3", ["major"] = "1", ["minor"] = "1", ["patch"] = "3", ["pre"] = "123.abc.0", ["build"] = "meta" } },
        { TestLine(), true,  "1.1.3-prerelease+123.abc.0", new() {  ["core"] = "1.1.3", ["major"] = "1", ["minor"] = "1", ["patch"] = "3", ["pre"] = "prerelease", ["build"] = "123.abc.0" } },
        { TestLine(), true,  "1.1.2+meta", new() {  ["core"] = "1.1.2", ["major"] = "1", ["minor"] = "1", ["patch"] = "2", ["pre"] = "", ["build"] = "meta" } },
        { TestLine(), true,  "1.1.2+meta-valid", new() {  ["core"] = "1.1.2", ["major"] = "1", ["minor"] = "1", ["patch"] = "2", ["pre"] = "", ["build"] = "meta-valid" } },
        { TestLine(), true,  "1.0.0-alpha", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-beta", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "beta", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha.beta", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha.beta", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha.beta.1", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha.beta.1", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha.1", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha.1", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha0.valid", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha0.valid", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha.0valid", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha.0valid", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha-a.b-c-somethinglong+build.1-aef.1-its-okay", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha-a.b-c-somethinglong", ["build"] = "build.1-aef.1-its-okay" } },
        { TestLine(), true,  "1.0.0-rc.1+build.1", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "rc.1", ["build"] = "build.1" } },
        { TestLine(), true,  "2.0.0-rc.1+build.123", new() {  ["core"] = "2.0.0", ["major"] = "2", ["minor"] = "0", ["patch"] = "0", ["pre"] = "rc.1", ["build"] = "build.123" } },
        { TestLine(), true,  "1.2.3-beta", new() {  ["core"] = "1.2.3", ["major"] = "1", ["minor"] = "2", ["patch"] = "3", ["pre"] = "beta", ["build"] = "" } },
        { TestLine(), true,  "10.2.3-DEV-SNAPSHOT", new() {  ["core"] = "10.2.3", ["major"] = "10", ["minor"] = "2", ["patch"] = "3", ["pre"] = "DEV-SNAPSHOT", ["build"] = "" } },
        { TestLine(), true,  "1.2.3-SNAPSHOT-123", new() {  ["core"] = "1.2.3", ["major"] = "1", ["minor"] = "2", ["patch"] = "3", ["pre"] = "SNAPSHOT-123", ["build"] = "" } },
        { TestLine(), true,  "1.0.0", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "2.0.0", new() {  ["core"] = "2.0.0", ["major"] = "2", ["minor"] = "0", ["patch"] = "0", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "1.1.7", new() {  ["core"] = "1.1.7", ["major"] = "1", ["minor"] = "1", ["patch"] = "7", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "2.0.0+build.1848", new() {  ["core"] = "2.0.0", ["major"] = "2", ["minor"] = "0", ["patch"] = "0", ["pre"] = "", ["build"] = "build.1848" } },
        { TestLine(), true,  "2.0.1-alpha.1227", new() {  ["core"] = "2.0.1", ["major"] = "2", ["minor"] = "0", ["patch"] = "1", ["pre"] = "alpha.1227", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-alpha+beta", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "alpha", ["build"] = "beta" } },
        { TestLine(), true,  "1.2.3----RC-SNAPSHOT.12.9.1--.12+788", new() {  ["core"] = "1.2.3", ["major"] = "1", ["minor"] = "2", ["patch"] = "3", ["pre"] = "---RC-SNAPSHOT.12.9.1--.12", ["build"] = "788" } },
        { TestLine(), true,  "1.2.3----R-S.12.9.1--.12+meta",        new() {  ["core"] = "1.2.3", ["major"] = "1", ["minor"] = "2", ["patch"] = "3", ["pre"] = "---R-S.12.9.1--.12", ["build"] = "meta" } },
        { TestLine(), true,  "1.2.3----RC-SNAPSHOT.12.9.1--.12",     new() {  ["core"] = "1.2.3", ["major"] = "1", ["minor"] = "2", ["patch"] = "3", ["pre"] = "---RC-SNAPSHOT.12.9.1--.12", ["build"] = "" } },
        { TestLine(), true,  "1.0.0+0.build.1-rc.10000aaa-kk-0.1",   new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "", ["build"] = "0.build.1-rc.10000aaa-kk-0.1" } },
        { TestLine(), true,  "99999999999999999999999.999999999999999999.99999999999999999",                                                             new() {  ["core"] = "99999999999999999999999.999999999999999999.99999999999999999", ["major"] = "99999999999999999999999", ["minor"] = "999999999999999999", ["patch"] = "99999999999999999", ["pre"] = "", ["build"] = "" } },
        { TestLine(), true,  "99999999999999999999999.999999999999999999.99999999999999999----RC-SNAPSHOT.12.0.9.1--------------------------------a.12", new() {  ["core"] = "99999999999999999999999.999999999999999999.99999999999999999", ["major"] = "99999999999999999999999", ["minor"] = "999999999999999999", ["patch"] = "99999999999999999", ["pre"] = "---RC-SNAPSHOT.12.0.9.1--------------------------------a.12", ["build"] = "" } },
        { TestLine(), true,  "1.0.0-0A.is.legal", new() {  ["core"] = "1.0.0", ["major"] = "1", ["minor"] = "0", ["patch"] = "0", ["pre"] = "0A.is.legal", ["build"] = "" } },
        { TestLine(), false, "1", null },
        { TestLine(), false, "1.2", null },
        { TestLine(), false, "1.2.3-0123", null },
        { TestLine(), false, "1.2.3-0123.0123", null },
        { TestLine(), false, "1.1.2+.123", null },
        { TestLine(), false, "1.1.2+0123", null },
        { TestLine(), true,  "1.1.2+0.123", new() {  ["core"] = "1.1.2", ["major"] = "1", ["minor"] = "1", ["patch"] = "2", ["pre"] = "", ["build"] = "0.123" } },
        { TestLine(), false, "+invalid", null },
        { TestLine(), false, "-invalid", null },
        { TestLine(), false, "-invalid+invalid", null },
        { TestLine(), false, "-invalid.01", null },
        { TestLine(), false, "alpha", null },
        { TestLine(), false, "alpha.beta", null },
        { TestLine(), false, "alpha.beta.1", null },
        { TestLine(), false, "alpha.1", null },
        { TestLine(), false, "alpha+beta", null },
        { TestLine(), false, "alpha_beta", null },
        { TestLine(), false, "alpha.", null },
        { TestLine(), false, "alpha..", null },
        { TestLine(), false, "beta", null },
        { TestLine(), false, "1.0.0-alpha_beta", null },
        { TestLine(), false, "-alpha.", null },
        { TestLine(), false, "1.0.0-alpha..", null },
        { TestLine(), false, "1.0.0-alpha..1", null },
        { TestLine(), false, "1.0.0-alpha...1", null },
        { TestLine(), false, "1.0.0-alpha....1", null },
        { TestLine(), false, "1.0.0-alpha.....1", null },
        { TestLine(), false, "1.0.0-alpha......1", null },
        { TestLine(), false, "1.0.0-alpha.......1", null },
        { TestLine(), false, "01.1.1", null },
        { TestLine(), false, "1.01.1", null },
        { TestLine(), false, "1.1.01", null },
        { TestLine(), false, "1.2", null },
        { TestLine(), false, "1.2.3.DEV", null },
        { TestLine(), false, "1.2-SNAPSHOT", null },
        { TestLine(), false, "1.2.31.2.3----RC-SNAPSHOT.12.09.1--..12+788", null },
        { TestLine(), false, "1.2-RC-SNAPSHOT", null },
        { TestLine(), false, "-1.0.3-gamma+b7718", null },
        { TestLine(), false, "+justmeta", null },
        { TestLine(), false, "9.8.7+meta+meta", null },
        { TestLine(), false, "9.8.7-whatever+meta+meta", null },
        { TestLine(), false, "99999999999999999999999.999999999999999999.99999999999999999----RC-SNAPSHOT.12.09.1--------------------------------..12", null },

    };

    [Theory]
    [MemberData(nameof(SemVerTestData))]
    public void TestSemVer(string TestLine, bool shouldBe, string input, Captures? captures)
        => base.RegexTest(SemVer.Regex, TestLine, shouldBe, input, captures);
}
